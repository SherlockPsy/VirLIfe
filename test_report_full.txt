============================= test session starts ==============================
platform darwin -- Python 3.13.5, pytest-9.0.1, pluggy-1.6.0 -- /usr/local/bin/python3
cachedir: .pytest_cache
rootdir: /Users/george/Library/Mobile Documents/com~apple~CloudDocs/01 - Rebecca/Cursor/VirLIfe
plugins: asyncio-1.3.0, anyio-3.7.1
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 342 items

tests/test_e2e_scenarios.py::TestQuietDayScenario::test_quiet_day_deterministic PASSED [  0%]
tests/test_e2e_scenarios.py::TestQuietDayScenario::test_quiet_day_no_cognition_triggered PASSED [  0%]
tests/test_e2e_scenarios.py::TestQuietDayScenario::test_quiet_day_renderer_perception_only PASSED [  0%]
tests/test_e2e_scenarios.py::TestHighStakesScenario::test_high_stakes_cognition_triggers PASSED [  1%]
tests/test_e2e_scenarios.py::TestHighStakesScenario::test_high_stakes_numeric_updates PASSED [  1%]
tests/test_e2e_scenarios.py::TestHighStakesScenario::test_high_stakes_determinism_with_cache PASSED [  1%]
tests/test_persistence.py::test_create_world_and_location PASSED         [  2%]
tests/test_persistence.py::test_create_agent_full_schema PASSED          [  2%]
tests/test_persistence.py::test_relationships_and_memories PASSED        [  2%]
tests/test_persistence.py::test_user_non_simulation PASSED               [  2%]
tests/test_persistence.py::test_agent_schema_shape PASSED                [  3%]
tests/test_persistence.py::test_relationship_model_allows_agent_to_agent_and_agent_to_user PASSED [  3%]
tests/test_persistence.py::test_restart_invariants PASSED                [  3%]
tests/test_personality.py::test_template_loading PASSED                  [  4%]
tests/test_personality.py::test_compiler_kernel_mixing PASSED            [  4%]
tests/test_personality.py::test_compiler_summaries PASSED                [  4%]
tests/test_personality.py::test_character_initialization PASSED          [  4%]
tests/test_personality.py::TestKernelDeterminism::test_same_mixture_produces_identical_kernel PASSED [  5%]
tests/test_personality.py::TestKernelDeterminism::test_different_mixtures_produce_different_kernels PASSED [  5%]
tests/test_personality.py::TestKernelDeterminism::test_fingerprint_modifiers_affect_kernel PASSED [  5%]
tests/test_personality.py::TestSummaryDeterminism::test_same_inputs_produce_identical_summary PASSED [  6%]
tests/test_personality.py::TestSummaryDeterminism::test_different_inputs_produce_different_summaries PASSED [  6%]
tests/test_personality.py::TestSummaryDeterminism::test_fingerprint_semantics_included_in_summary PASSED [  6%]
tests/test_personality.py::TestSummaryDeterminism::test_summary_regenerates_when_inputs_change PASSED [  7%]
tests/test_personality.py::TestInitialBiographicalMemoryAndRelationships::test_initial_biographical_memories_exist PASSED [  7%]
tests/test_personality.py::TestInitialBiographicalMemoryAndRelationships::test_initial_relationships_toward_user_exist PASSED [  7%]
tests/test_personality.py::TestNonLLM::test_compiler_has_no_llm_imports PASSED [  7%]
tests/test_personality.py::TestNonLLM::test_compiler_has_no_llm_calls PASSED [  8%]
tests/test_personality.py::TestNonLLM::test_initialization_has_no_llm_imports PASSED [  8%]
tests/test_personality.py::TestNonLLM::test_compiler_is_purely_deterministic PASSED [  8%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_master_spec_exists PASSED [  9%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_architecture_exists PASSED [  9%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_plan_exists PASSED [  9%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_builder_contract_exists PASSED [  9%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_router_prompt_exists PASSED [ 10%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_codex_dev_instructions_exists PASSED [ 10%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_cognition_flow_exists PASSED [ 10%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_numeric_semantic_mapping_exists PASSED [ 11%]
tests/test_phase0_health_and_docs.py::TestDocumentationPresence::test_test_suite_outline_exists PASSED [ 11%]
tests/test_phase0_health_and_docs.py::TestDocumentationReadability::test_master_spec_readable PASSED [ 11%]
tests/test_phase0_health_and_docs.py::TestDocumentationReadability::test_architecture_readable PASSED [ 11%]
tests/test_phase0_health_and_docs.py::TestDocumentationReadability::test_plan_readable PASSED [ 12%]
tests/test_phase0_health_and_docs.py::TestDocumentationReadability::test_builder_contract_readable PASSED [ 12%]
tests/test_phase0_health_and_docs.py::TestDocumentationReadability::test_cognition_flow_readable PASSED [ 12%]
tests/test_phase0_health_and_docs.py::TestDocumentationReadability::test_numeric_semantic_mapping_readable PASSED [ 13%]
tests/test_phase0_health_and_docs.py::TestHealthEndpoint::test_health_endpoint_exists PASSED [ 13%]
tests/test_phase0_health_and_docs.py::TestHealthEndpoint::test_health_endpoint_returns_json PASSED [ 13%]
tests/test_phase0_health_and_docs.py::TestHealthEndpoint::test_health_endpoint_has_status_key PASSED [ 14%]
tests/test_phase0_health_and_docs.py::TestHealthEndpoint::test_health_endpoint_has_environment_key PASSED [ 14%]
tests/test_phase0_health_and_docs.py::TestHealthEndpoint::test_health_endpoint_handles_db_unreachable_gracefully PASSED [ 14%]
tests/test_phase2_calendars.py::test_calendar_edge_cases PASSED          [ 14%]
tests/test_phase2_calendars.py::test_calendar_reminders_timing PASSED    [ 15%]
tests/test_phase2_calendars.py::test_calendar_missed_obligation PASSED   [ 15%]
tests/test_phase2_comprehensive.py::TestWorldTickDeterminism::test_world_tick_determinism_with_two_agents PASSED [ 15%]
tests/test_phase2_comprehensive.py::TestCalendarEdgeCases::test_no_upcoming_events_no_crash_no_reminders PASSED [ 16%]
tests/test_phase2_comprehensive.py::TestCalendarEdgeCases::test_multiple_overlapping_events_correct_reminders PASSED [ 16%]
tests/test_phase2_comprehensive.py::TestCalendarEdgeCases::test_boundary_condition_one_reminder PASSED [ 16%]
tests/test_phase2_comprehensive.py::TestCalendarEdgeCases::test_missed_events_generate_calendar_missed PASSED [ 16%]
tests/test_phase2_comprehensive.py::TestIncursionEngine::test_incursion_determinism PASSED [ 17%]
tests/test_phase2_comprehensive.py::TestIncursionEngine::test_incursions_stored_as_events PASSED [ 17%]
tests/test_phase2_comprehensive.py::TestIncursionEngine::test_incursion_descriptions_grounded_in_context PASSED [ 17%]
tests/test_phase2_comprehensive.py::TestContinuity::test_agents_move_by_deterministic_routines PASSED [ 18%]
tests/test_phase2_comprehensive.py::TestContinuity::test_repeated_runs_produce_same_locations PASSED [ 18%]
tests/test_phase2_determinism.py::test_tick_determinism PASSED           [ 18%]
tests/test_phase2_determinism.py::test_incursion_structure PASSED        [ 19%]
tests/test_phase2_determinism.py::test_off_screen_continuity PASSED      [ 19%]
tests/test_phase3_autonomy.py::TestAutonomyEngine::test_arc_progression PASSED [ 19%]
tests/test_phase3_autonomy.py::TestAutonomyEngine::test_drive_updates PASSED [ 19%]
tests/test_phase3_autonomy.py::TestAutonomyEngine::test_energy_depletion PASSED [ 20%]
tests/test_phase3_autonomy.py::TestAutonomyEngine::test_intention_completion PASSED [ 20%]
tests/test_phase3_autonomy.py::TestAutonomyEngine::test_memory_creation PASSED [ 20%]
tests/test_phase3_autonomy.py::TestAutonomyEngine::test_mood_updates PASSED [ 21%]
tests/test_phase3_autonomy.py::TestAutonomyEngine::test_relationship_drift PASSED [ 21%]
tests/test_phase3_comprehensive.py::TestDriveUpdateLaw::test_drive_effect_in_valid_range PASSED [ 21%]
tests/test_phase3_comprehensive.py::TestDriveUpdateLaw::test_sensitivity_applied_to_drive_effects PASSED [ 21%]
tests/test_phase3_comprehensive.py::TestDriveUpdateLaw::test_drive_clamped_to_valid_range PASSED [ 22%]
tests/test_phase3_comprehensive.py::TestDriveUpdateLaw::test_drive_drift_toward_baseline PASSED [ 22%]
tests/test_phase3_comprehensive.py::TestMoodLaw::test_positive_drive_history_increases_valence PASSED [ 22%]
tests/test_phase3_comprehensive.py::TestMoodLaw::test_negative_drive_history_decreases_valence PASSED [ 23%]
tests/test_phase3_comprehensive.py::TestMoodLaw::test_arousal_responds_to_novelty_conflict PASSED [ 23%]
tests/test_phase3_comprehensive.py::TestMoodLaw::test_arousal_decays_toward_baseline PASSED [ 23%]
tests/test_phase3_comprehensive.py::TestRelationshipDriftAndUpdates::test_relationship_drift_with_no_events PASSED [ 23%]
tests/test_phase3_comprehensive.py::TestRelationshipDriftAndUpdates::test_positive_events_increase_warmth_trust_decrease_tension PASSED [ 24%]
tests/test_phase3_comprehensive.py::TestRelationshipDriftAndUpdates::test_negative_events_decrease_warmth_trust_increase_tension PASSED [ 24%]
tests/test_phase3_comprehensive.py::TestEnergyModel::test_energy_falls_under_workload_high_arousal PASSED [ 24%]
tests/test_phase3_comprehensive.py::TestEnergyModel::test_energy_recovers_during_rest_ticks PASSED [ 25%]
tests/test_phase4_mapping.py::TestMoodMapper::test_positive_calm_mood PASSED [ 25%]
tests/test_phase4_mapping.py::TestMoodMapper::test_positive_energized_mood PASSED [ 25%]
tests/test_phase4_mapping.py::TestMoodMapper::test_neutral_calm_mood PASSED [ 26%]
tests/test_phase4_mapping.py::TestMoodMapper::test_negative_upset_mood PASSED [ 26%]
tests/test_phase4_mapping.py::TestMoodMapper::test_mood_determinism PASSED [ 26%]
tests/test_phase4_mapping.py::TestMoodMapper::test_mood_clamps_valence PASSED [ 26%]
tests/test_phase4_mapping.py::TestMoodMapper::test_mood_no_numeric_values PASSED [ 27%]
tests/test_phase4_mapping.py::TestDriveMapper::test_relatedness_low_pressure PASSED [ 27%]
tests/test_phase4_mapping.py::TestDriveMapper::test_relatedness_high_pressure PASSED [ 27%]
tests/test_phase4_mapping.py::TestDriveMapper::test_autonomy_low_pressure PASSED [ 28%]
tests/test_phase4_mapping.py::TestDriveMapper::test_autonomy_high_pressure PASSED [ 28%]
tests/test_phase4_mapping.py::TestDriveMapper::test_competence_low_pressure PASSED [ 28%]
tests/test_phase4_mapping.py::TestDriveMapper::test_competence_high_pressure PASSED [ 28%]
tests/test_phase4_mapping.py::TestDriveMapper::test_novelty_low_pressure PASSED [ 29%]
tests/test_phase4_mapping.py::TestDriveMapper::test_novelty_high_pressure PASSED [ 29%]
tests/test_phase4_mapping.py::TestDriveMapper::test_safety_low_pressure PASSED [ 29%]
tests/test_phase4_mapping.py::TestDriveMapper::test_safety_high_pressure PASSED [ 30%]
tests/test_phase4_mapping.py::TestDriveMapper::test_drive_determinism PASSED [ 30%]
tests/test_phase4_mapping.py::TestDriveMapper::test_map_drive_by_name PASSED [ 30%]
tests/test_phase4_mapping.py::TestDriveMapper::test_get_highest_pressure_drives PASSED [ 30%]
tests/test_phase4_mapping.py::TestRelationshipMapper::test_close_safe_relationship PASSED [ 31%]
tests/test_phase4_mapping.py::TestRelationshipMapper::test_strained_relationship PASSED [ 31%]
tests/test_phase4_mapping.py::TestRelationshipMapper::test_conflicted_relationship PASSED [ 31%]
tests/test_phase4_mapping.py::TestRelationshipMapper::test_neutral_relationship PASSED [ 32%]
tests/test_phase4_mapping.py::TestRelationshipMapper::test_full_relationship_with_attraction PASSED [ 32%]
tests/test_phase4_mapping.py::TestArcMapper::test_intense_negative_arc PASSED [ 32%]
tests/test_phase4_mapping.py::TestArcMapper::test_moderate_negative_arc PASSED [ 33%]
tests/test_phase4_mapping.py::TestArcMapper::test_intense_positive_arc PASSED [ 33%]
tests/test_phase4_mapping.py::TestArcMapper::test_mild_arc PASSED        [ 33%]
tests/test_phase4_mapping.py::TestArcMapper::test_arc_maps_arcs_summary PASSED [ 33%]
tests/test_phase4_mapping.py::TestEnergyMapper::test_high_energy PASSED  [ 34%]
tests/test_phase4_mapping.py::TestEnergyMapper::test_medium_energy PASSED [ 34%]
tests/test_phase4_mapping.py::TestEnergyMapper::test_low_energy PASSED   [ 34%]
tests/test_phase4_mapping.py::TestIntentionMapper::test_avoid_intention PASSED [ 35%]
tests/test_phase4_mapping.py::TestIntentionMapper::test_raise_intention PASSED [ 35%]
tests/test_phase4_mapping.py::TestIntentionMapper::test_support_intention PASSED [ 35%]
tests/test_phase4_mapping.py::TestIntentionMapper::test_high_priority_intention PASSED [ 35%]
tests/test_phase4_mapping.py::TestPersonalityMapper::test_kernel_to_stable_summary PASSED [ 36%]
tests/test_phase4_mapping.py::TestPersonalityMapper::test_kernel_to_domain_summaries PASSED [ 36%]
tests/test_phase4_mapping.py::TestPersonalityMapper::test_dynamic_activation_packet PASSED [ 36%]
tests/test_phase4_mapping.py::TestCognitionContextBuilder::test_build_cognition_context_no_numerics PASSED [ 37%]
tests/test_phase4_mapping.py::TestCognitionContextBuilder::test_cognition_context_includes_personality PASSED [ 37%]
tests/test_phase4_mapping.py::TestRendererContextBuilder::test_build_renderer_context_perception_only PASSED [ 37%]
tests/test_phase4_mapping.py::TestRendererContextBuilder::test_renderer_context_no_user_internal_state PASSED [ 38%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_drive_level_to_salience_zero PASSED [ 38%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_drive_level_to_salience_high PASSED [ 38%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_drive_level_to_salience_mid PASSED [ 38%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_arc_intensity_to_salience_low PASSED [ 39%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_arc_intensity_to_salience_high PASSED [ 39%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_people_salience_physically_present PASSED [ 39%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_people_salience_recently_interacted PASSED [ 40%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_people_salience_background PASSED [ 40%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_people_salience_relationship_stakes_boost PASSED [ 40%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_topic_salience_no_arc PASSED [ 40%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_topic_salience_with_hot_arc PASSED [ 41%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_object_salience_critical PASSED [ 41%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_object_salience_background PASSED [ 41%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_drive_salience_all_drives PASSED [ 42%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_compute_arc_salience_multiple_arcs PASSED [ 42%]
tests/test_phase5_cognition.py::TestSalienceCalculator::test_build_salience_context_complete PASSED [ 42%]
tests/test_phase5_cognition.py::TestMeaningfulnessCalculator::test_m_score_basic_computation PASSED [ 42%]
tests/test_phase5_cognition.py::TestMeaningfulnessCalculator::test_m_score_low_energy_penalty PASSED [ 43%]
tests/test_phase5_cognition.py::TestMeaningfulnessCalculator::test_m_score_above_threshold PASSED [ 43%]
tests/test_phase5_cognition.py::TestMeaningfulnessCalculator::test_m_score_below_threshold PASSED [ 43%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_1_m_score_sufficient PASSED [ 44%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_2_event_not_trivial PASSED [ 44%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_3_cooldown_no_prior_cognition PASSED [ 44%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_3_cooldown_elapsed PASSED [ 45%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_3_cooldown_not_elapsed PASSED [ 45%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_3_cooldown_remaining PASSED [ 45%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_4_behavioral_choice_non_trivial PASSED [ 45%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_factor_4_behavioral_choice_all_trivial PASSED [ 46%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_eligibility_all_pass PASSED [ 46%]
tests/test_phase5_cognition.py::TestCognitionEligibilityChecker::test_eligibility_m_score_fails PASSED [ 46%]
tests/test_phase5_cognition.py::TestLLMResponseValidator::test_validate_no_numeric_state_assignment PASSED [ 47%]
tests/test_phase5_cognition.py::TestLLMResponseValidator::test_validate_numeric_context_allowed PASSED [ 47%]
tests/test_phase5_cognition.py::TestLLMResponseValidator::test_validate_no_personality_redefinition PASSED [ 47%]
tests/test_phase5_cognition.py::TestLLMResponseValidator::test_validate_personality_shift_allowed PASSED [ 47%]
tests/test_phase5_cognition.py::TestLLMResponseValidator::test_validate_response_valid PASSED [ 48%]
tests/test_phase5_cognition.py::TestLLMResponseValidator::test_validate_response_missing_fields PASSED [ 48%]
tests/test_phase5_cognition.py::TestStanceShiftMapper::test_get_stance_shift_mapping_found PASSED [ 48%]
tests/test_phase5_cognition.py::TestStanceShiftMapper::test_get_stance_shift_mapping_not_found PASSED [ 49%]
tests/test_phase5_cognition.py::TestStanceShiftMapper::test_apply_stance_shift_trust PASSED [ 49%]
tests/test_phase5_cognition.py::TestStanceShiftMapper::test_apply_stance_shift_warmth PASSED [ 49%]
tests/test_phase5_cognition.py::TestStanceShiftMapper::test_apply_stance_shift_unknown PASSED [ 50%]
tests/test_phase5_cognition.py::TestIntentionUpdateMapper::test_compute_intention_drive_effects_create_support PASSED [ 50%]
tests/test_phase5_cognition.py::TestIntentionUpdateMapper::test_compute_intention_drive_effects_drop_drops_effect PASSED [ 50%]
tests/test_phase5_cognition.py::TestIntentionUpdateMapper::test_compute_intention_drive_effects_horizon_scaling PASSED [ 50%]
tests/test_phase5_cognition.py::TestIntentionUpdateMapper::test_apply_intention_update_avoid PASSED [ 51%]
tests/test_phase5_cognition.py::TestCognitionServiceIntegration::test_cognition_input_output_structure PASSED [ 51%]
tests/test_phase5_cognition.py::TestCognitionServiceIntegration::test_cognition_service_processes_input PASSED [ 51%]
tests/test_phase5_cognition.py::TestCognitionServiceIntegration::test_cognition_service_ineligible_trivial PASSED [ 52%]
tests/test_phase5_cognition.py::TestDeterminism::test_salience_computation_deterministic PASSED [ 52%]
tests/test_phase5_cognition.py::TestDeterminism::test_meaningfulness_computation_deterministic PASSED [ 52%]
tests/test_phase5_cognition.py::TestDeterminism::test_stance_shift_deterministic PASSED [ 52%]
tests/test_phase5_cognition.py::TestCalendarAndUnexpectedEventContext::test_cognition_input_accepts_calendar_context PASSED [ 53%]
tests/test_phase5_cognition.py::TestCalendarAndUnexpectedEventContext::test_cognition_input_accepts_unexpected_event_context PASSED [ 53%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_perceivable_entity_basic PASSED [ 53%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_perceivable_entity_object PASSED [ 54%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_perception_delta_changes PASSED [ 54%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_perception_packet_basic PASSED [ 54%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_builder_user_pov PASSED [ 54%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_builder_agent_pov PASSED [ 55%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_perception_packet_with_delta PASSED [ 55%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_builder_multiple_visible_entities PASSED [ 55%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_builder_no_visible_entities PASSED [ 56%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_perception_packet_with_incursion PASSED [ 56%]
tests/test_phase6_renderer.py::TestPerceptionPacketBuilder::test_perception_packet_with_calendar PASSED [ 56%]
tests/test_phase6_renderer.py::TestRendererRouter::test_classify_standard_scene PASSED [ 57%]
tests/test_phase6_renderer.py::TestRendererRouter::test_classify_routine_scene PASSED [ 57%]
tests/test_phase6_renderer.py::TestRendererRouter::test_classify_sexual_by_keyword PASSED [ 57%]
tests/test_phase6_renderer.py::TestRendererRouter::test_classify_sexual_explicit_flag PASSED [ 57%]
tests/test_phase6_renderer.py::TestRendererRouter::test_classify_violent_scene PASSED [ 58%]
tests/test_phase6_renderer.py::TestRendererRouter::test_classify_emotional_scene PASSED [ 58%]
tests/test_phase6_renderer.py::TestRendererRouter::test_classify_suggestive_flirting PASSED [ 58%]
tests/test_phase6_renderer.py::TestRendererRouter::test_route_standard_scene_uses_reasoning_model PASSED [ 59%]
tests/test_phase6_renderer.py::TestRendererRouter::test_route_sexual_scene_with_adult_content_allowed PASSED [ 59%]
tests/test_phase6_renderer.py::TestRendererRouter::test_route_sexual_scene_with_adult_content_disallowed PASSED [ 59%]
tests/test_phase6_renderer.py::TestRendererRouter::test_route_violent_scene PASSED [ 59%]
tests/test_phase6_renderer.py::TestRendererRouter::test_route_emotional_scene PASSED [ 60%]
tests/test_phase6_renderer.py::TestRendererRouter::test_route_routine_scene PASSED [ 60%]
tests/test_phase6_renderer.py::TestRendererRouter::test_multiple_sexual_keywords PASSED [ 60%]
tests/test_phase6_renderer.py::TestRendererRouter::test_routing_determinism PASSED [ 61%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_valid_user_pov_narrative PASSED [ 61%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_valid_agent_pov_narrative PASSED [ 61%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_user_internal_state PASSED [ 61%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_user_thinking PASSED [ 62%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_user_believing PASSED [ 62%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_omniscience_agent_thoughts PASSED [ 62%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_omniscience_inward_feelings PASSED [ 63%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_pov_consistency_user_must_use_you PASSED [ 63%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_pov_consistency_agent_must_use_i PASSED [ 63%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_empty_narrative PASSED [ 64%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_narrative_without_punctuation PASSED [ 64%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_reject_excessively_long_narrative PASSED [ 64%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_valid_narrative_with_warnings PASSED [ 64%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_no_internal_state_valid_patterns PASSED [ 65%]
tests/test_phase6_renderer.py::TestRendererResponseValidator::test_deterministic_validation PASSED [ 65%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_classify_sensory_incursion PASSED [ 65%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_classify_arrival_incursion PASSED [ 66%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_classify_knock_as_arrival PASSED [ 66%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_classify_digital_incursion PASSED [ 66%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_classify_irregularity_incursion PASSED [ 66%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_classify_obligation_incursion PASSED [ 67%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_get_rendering_strategy_sensory PASSED [ 67%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_get_rendering_strategy_arrival PASSED [ 67%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_should_render_incursion PASSED [ 68%]
tests/test_phase6_renderer.py::TestIncursionRenderer::test_prepare_incursion_context PASSED [ 68%]
tests/test_phase6_renderer.py::TestRendererSystemPrompt::test_system_prompt_user_pov PASSED [ 68%]
tests/test_phase6_renderer.py::TestRendererSystemPrompt::test_system_prompt_agent_pov PASSED [ 69%]
tests/test_phase6_renderer.py::TestRendererSystemPrompt::test_system_prompt_with_adult_content PASSED [ 69%]
tests/test_phase6_renderer.py::TestRendererSystemPrompt::test_system_prompt_no_internal_state_instruction PASSED [ 69%]
tests/test_phase6_renderer.py::TestRendererSystemPrompt::test_system_prompt_emphasizes_perception PASSED [ 69%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_initialization PASSED [ 70%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_world_state_user_pov PASSED [ 70%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_world_state_agent_pov PASSED [ 70%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_event PASSED [ 71%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_scene_chunk PASSED [ 71%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_no_cognition_integration PASSED [ 71%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_uses_mapping_layer PASSED [ 71%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_uses_world_repo PASSED [ 72%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_uses_personality_summaries PASSED [ 72%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_determinism PASSED [ 72%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_no_numeric_leakage PASSED [ 73%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_handles_empty_world PASSED [ 73%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_handles_missing_location PASSED [ 73%]
tests/test_phase6_renderer.py::TestRenderEngineIntegration::test_render_engine_continuity_caching PASSED [ 73%]
tests/test_phase7_gateway.py::test_user_action_required_fields PASSED    [ 74%]
tests/test_phase7_gateway.py::test_world_advance_default_ticks PASSED    [ 74%]
tests/test_phase7_gateway.py::test_render_default_pov PASSED             [ 74%]
tests/test_phase7_gateway.py::test_endpoint_exists PASSED                [ 75%]
tests/test_phase7_gateway.py::TestGatewayController::test_controller_initialization PASSED [ 75%]
tests/test_phase7_gateway.py::TestGatewayController::test_handle_user_action PASSED [ 75%]
tests/test_phase7_gateway.py::TestGatewayController::test_handle_world_advance_deterministic PASSED [ 76%]
tests/test_phase7_gateway.py::TestGatewayController::test_handle_render_retrieves_output PASSED [ 76%]
tests/test_phase7_gateway.py::TestGatewayController::test_handle_status PASSED [ 76%]
tests/test_phase7_gateway.py::TestGatewayController::test_controller_orchestrates_subsystems PASSED [ 76%]
tests/test_phase7_gateway.py::TestGatewayController::test_controller_no_new_logic PASSED [ 77%]
tests/test_phase7_gateway.py::TestGatewayController::test_world_advance_integrates_autonomy PASSED [ 77%]
tests/test_phase7_gateway.py::TestGatewayController::test_render_integrates_renderer PASSED [ 77%]
tests/test_phase7_gateway.py::TestGatewayController::test_cognition_triggered_only_when_meaningful PASSED [ 78%]
tests/test_phase8_environment.py::TestEnvironmentConfig::test_database_url_configured PASSED [ 78%]
tests/test_phase8_environment.py::TestEnvironmentConfig::test_no_redis_in_phase8 PASSED [ 78%]
tests/test_phase8_environment.py::TestEnvironmentConfig::test_no_qdrant_in_phase8 PASSED [ 78%]
tests/test_phase8_environment.py::TestEnvironmentConfig::test_required_variables_present PASSED [ 79%]
tests/test_phase8_environment.py::TestEnvironmentConfig::test_environment_name_set PASSED [ 79%]
tests/test_phase8_environment.py::TestEnvironmentConfig::test_app_name_set PASSED [ 79%]
tests/test_phase8_environment.py::TestPhase8Constraints::test_redis_not_imported_in_core PASSED [ 80%]
tests/test_phase8_environment.py::TestPhase8Constraints::test_qdrant_not_imported_in_core PASSED [ 80%]
tests/test_phase8_environment.py::TestPhase8Constraints::test_settings_loads_without_redis PASSED [ 80%]
tests/test_phase8_environment.py::TestPhase8Constraints::test_settings_loads_without_qdrant PASSED [ 80%]
tests/test_phase8_environment.py::TestRailwayCompatibility::test_port_variable_handled PASSED [ 81%]
tests/test_phase8_environment.py::TestRailwayCompatibility::test_database_url_format PASSED [ 81%]
tests/test_phase9_cache.py::TestRedisCaching::test_redis_is_optional PASSED [ 81%]
tests/test_phase9_cache.py::TestRedisCaching::test_redis_cache_hit_miss PASSED [ 82%]
tests/test_phase9_cache.py::TestRedisCaching::test_redis_graceful_degradation PASSED [ 82%]
tests/test_phase9_cache.py::TestQdrantMemory::test_qdrant_is_optional PASSED [ 82%]
tests/test_phase9_cache.py::TestQdrantMemory::test_qdrant_queries_deterministic PASSED [ 83%]
tests/test_phase9_cache.py::TestQdrantMemory::test_no_numeric_leakage PASSED [ 83%]
tests/test_phase9_cache.py::TestQdrantMemory::test_memory_embedding_invariants PASSED [ 83%]
tests/test_phase9_cache.py::TestPhase9Integration::test_redis_with_personality_compiler PASSED [ 83%]
tests/test_phase9_cache.py::TestPhase9Integration::test_qdrant_with_memory_retrieval PASSED [ 84%]
tests/test_phase9_cache.py::TestPhase9Integration::test_redis_with_renderer PASSED [ 84%]
tests/test_phase9_cache.py::TestPhase9Constraints::test_redis_not_authoritative PASSED [ 84%]
tests/test_phase9_cache.py::TestPhase9Constraints::test_qdrant_not_authoritative PASSED [ 85%]
tests/test_phase9_cache.py::TestPhase9Constraints::test_postgres_remains_source_of_truth PASSED [ 85%]
tests/test_phase9_integration.py::TestPhase9CachingIntegration::test_cognition_event_hash_deterministic PASSED [ 85%]
tests/test_phase9_integration.py::TestPhase9CachingIntegration::test_cognition_event_hash_different_for_different_contexts PASSED [ 85%]
tests/test_phase9_integration.py::TestPhase9CachingIntegration::test_renderer_context_hash_deterministic PASSED [ 86%]
tests/test_phase9_integration.py::TestPhase9CachingIntegration::test_renderer_context_hash_different_for_different_contexts PASSED [ 86%]
tests/test_phase9_integration.py::TestPhase9ServiceIntegration::test_redis_service_importable_in_cognition PASSED [ 86%]
tests/test_phase9_integration.py::TestPhase9ServiceIntegration::test_qdrant_service_importable_in_cognition PASSED [ 87%]
tests/test_phase9_integration.py::TestPhase9ServiceIntegration::test_redis_service_importable_in_renderer PASSED [ 87%]
tests/test_phase9_integration.py::TestPhase9ServiceIntegration::test_cognition_has_both_sync_and_async_methods PASSED [ 87%]
tests/test_phase9_integration.py::TestPhase9ServiceIntegration::test_cognition_has_event_hash_utility PASSED [ 88%]
tests/test_phase9_integration.py::TestPhase9ServiceIntegration::test_renderer_has_context_hash_utility PASSED [ 88%]
tests/test_phase9_integration.py::TestPhase9ServiceIntegration::test_cache_service_has_ttl_constants PASSED [ 88%]
tests/test_phase9_integration.py::TestPhase9MemoryServices::test_memory_service_has_search_methods PASSED [ 88%]
tests/test_phase9_integration.py::TestPhase9MemoryServices::test_memory_hit_dataclass_exists PASSED [ 89%]
tests/test_phase9_integration.py::TestRedisCacheApi::test_perception_cache_scoped_by_context_hash PASSED [ 89%]
tests/test_phase9_integration.py::TestRedisCacheApi::test_cognition_cooldown_accepts_minutes PASSED [ 89%]
tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_simulation_determinism FAILED [ 90%]
tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_simulation_state_invariants FAILED [ 90%]
tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_memory_growth FAILED [ 90%]
tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_performance_stability FAILED [ 90%]
tests/test_phase9_performance.py::TestPerformanceBaseline::test_cognition_service_baseline_performance PASSED [ 91%]
tests/test_phase9_performance.py::TestPerformanceBaseline::test_renderer_baseline_performance PASSED [ 91%]
tests/test_phase9_performance.py::TestCachingEffectiveness::test_redis_cache_hit_simulation PASSED [ 91%]
tests/test_phase9_performance.py::TestMemoryServiceScalability::test_qdrant_memory_search_scalability SKIPPED [ 92%]
tests/test_phase9_performance.py::TestCacheTTLOptimization::test_cache_ttl_values_are_optimal PASSED [ 92%]
tests/test_phase9_performance.py::TestCacheTTLOptimization::test_cache_key_determinism PASSED [ 92%]
tests/test_phase9_performance.py::TestGracefulDegradationPerformance::test_cognition_without_cache_is_stable PASSED [ 92%]
tests/test_phase9_performance.py::TestCacheConsistency::test_cache_doesnt_corrupt_postgres_data PASSED [ 93%]
tests/test_phase9_railway_smoke.py::TestRailwayEnvironmentVariables::test_database_url_is_configured PASSED [ 93%]
tests/test_phase9_railway_smoke.py::TestRailwayEnvironmentVariables::test_redis_url_optional_but_can_be_configured PASSED [ 93%]
tests/test_phase9_railway_smoke.py::TestRailwayEnvironmentVariables::test_qdrant_url_optional_but_can_be_configured PASSED [ 94%]
tests/test_phase9_railway_smoke.py::TestRedisIntegrationSmoke::test_redis_service_imports PASSED [ 94%]
tests/test_phase9_railway_smoke.py::TestRedisIntegrationSmoke::test_redis_ttl_constants PASSED [ 94%]
tests/test_phase9_railway_smoke.py::TestRedisIntegrationSmoke::test_cognition_async_method_exists PASSED [ 95%]
tests/test_phase9_railway_smoke.py::TestRedisIntegrationSmoke::test_event_hash_utility_exists PASSED [ 95%]
tests/test_phase9_railway_smoke.py::TestQdrantIntegrationSmoke::test_qdrant_service_imports PASSED [ 95%]
tests/test_phase9_railway_smoke.py::TestQdrantIntegrationSmoke::test_memory_hit_dataclass PASSED [ 95%]
tests/test_phase9_railway_smoke.py::TestQdrantIntegrationSmoke::test_qdrant_collections_configured PASSED [ 96%]
tests/test_phase9_railway_smoke.py::TestRendererRedisIntegration::test_renderer_has_context_hash_utility PASSED [ 96%]
tests/test_phase9_railway_smoke.py::TestRendererRedisIntegration::test_context_hash_deterministic PASSED [ 96%]
tests/test_phase9_railway_smoke.py::TestRendererRedisIntegration::test_context_hash_differs_for_different_contexts PASSED [ 97%]
tests/test_phase9_railway_smoke.py::TestGracefulDegradation::test_cognition_service_works_without_redis PASSED [ 97%]
tests/test_phase9_railway_smoke.py::TestGracefulDegradation::test_renderer_works_without_redis PASSED [ 97%]
tests/test_phase9_railway_smoke.py::TestPhase7EndpointsWithCaching::test_gateway_api_has_required_methods PASSED [ 97%]
tests/test_phase9_railway_smoke.py::TestPhase7EndpointsWithCaching::test_cognition_service_backward_compatible PASSED [ 98%]
tests/test_phase9_railway_smoke.py::TestHealthCheckEndpoints::test_health_check_has_required_fields PASSED [ 98%]
tests/test_phase9_railway_smoke.py::TestHealthCheckEndpoints::test_full_health_check_includes_services PASSED [ 98%]
tests/test_world.py::test_world_tick PASSED                              [ 99%]
tests/test_world.py::test_movement PASSED                                [ 99%]
tests/test_world.py::test_calendar_events PASSED                         [ 99%]
tests/test_world.py::test_incursion_generation PASSED                    [100%]

=================================== FAILURES ===================================
_______ TestLongDurationSimulation.test_100_tick_simulation_determinism ________
tests/test_phase9_long_simulation.py:39: in test_100_tick_simulation_determinism
    from backend.persistence.repo import WorldRepository, AgentRepository
E   ImportError: cannot import name 'WorldRepository' from 'backend.persistence.repo' (/Users/george/Library/Mobile Documents/com~apple~CloudDocs/01 - Rebecca/Cursor/VirLIfe/backend/persistence/repo.py)
_____ TestLongDurationSimulation.test_100_tick_simulation_state_invariants _____
tests/test_phase9_long_simulation.py:116: in test_100_tick_simulation_state_invariants
    from backend.persistence.repo import WorldRepository, AgentRepository
E   ImportError: cannot import name 'WorldRepository' from 'backend.persistence.repo' (/Users/george/Library/Mobile Documents/com~apple~CloudDocs/01 - Rebecca/Cursor/VirLIfe/backend/persistence/repo.py)
____________ TestLongDurationSimulation.test_100_tick_memory_growth ____________
tests/test_phase9_long_simulation.py:179: in test_100_tick_memory_growth
    from backend.persistence.repo import WorldRepository, AgentRepository
E   ImportError: cannot import name 'WorldRepository' from 'backend.persistence.repo' (/Users/george/Library/Mobile Documents/com~apple~CloudDocs/01 - Rebecca/Cursor/VirLIfe/backend/persistence/repo.py)
________ TestLongDurationSimulation.test_100_tick_performance_stability ________
tests/test_phase9_long_simulation.py:223: in test_100_tick_performance_stability
    from backend.persistence.repo import WorldRepository, AgentRepository
E   ImportError: cannot import name 'WorldRepository' from 'backend.persistence.repo' (/Users/george/Library/Mobile Documents/com~apple~CloudDocs/01 - Rebecca/Cursor/VirLIfe/backend/persistence/repo.py)
=============================== warnings summary ===============================
backend/main.py:53
  /Users/george/Library/Mobile Documents/com~apple~CloudDocs/01 - Rebecca/Cursor/VirLIfe/backend/main.py:53: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("startup")

../../../../../../../../Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/applications.py:4575
../../../../../../../../Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/applications.py:4575
  /Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/applications.py:4575: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    return self.router.on_event(event_type)

backend/main.py:68
  /Users/george/Library/Mobile Documents/com~apple~CloudDocs/01 - Rebecca/Cursor/VirLIfe/backend/main.py:68: DeprecationWarning: 
          on_event is deprecated, use lifespan event handlers instead.
  
          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
          
    @app.on_event("shutdown")

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_simulation_determinism
FAILED tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_simulation_state_invariants
FAILED tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_memory_growth
FAILED tests/test_phase9_long_simulation.py::TestLongDurationSimulation::test_100_tick_performance_stability
============= 4 failed, 337 passed, 1 skipped, 4 warnings in 1.92s =============
